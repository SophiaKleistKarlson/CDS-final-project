---
title: "Code for CDS final project - plotting"
author: "Sophia Kleist Karlson"
date: "25 nov 2020"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# load necesary packages through pacman
pacman::p_load(tidyverse, stringr, dplyr, tidyr, ggplot2)

# set working directory
setwd("~/Social Transmission Study/Analysis of drawings/")

# RStudio version
RStudio.Version()

# Load data
data <- read.csv("data/csv_files/all_data_w_all_conv_source.csv")

```



Checking the data 
```{r}
# check classes of the variables of interest
class(data$Condition)
class(data$Generation)
class(data$Conventionality)
class(data$Complexity)

# change class for generation and condition to factor, and complexity and conventionality to numeric
data$Condition <- as.factor(data$Condition)
data$Generation <- as.factor(data$Generation)
data$Conventionality <- as.numeric(data$Conventionality)
data$Complexity <- as.numeric(data$Complexity)

# check range, mean and sd of conventionality and complexity
range(data$Conventionality) # 0-10
mean(data$Conventionality) # 4.33
sd(data$Conventionality) # 2.80

range(data$Complexity) # 4287-50067
mean(data$Complexity) # 24641.25
sd(data$Complexity) # 6399.958
```


Plots 

I chose to make barplots with the standard error as errorbars. Each plot shows the generation on the x-axis (from 0-7, 0 being the source images) and either the complexity or conventionality scores on the y-axis. For each generation, four bars represent each condition, color-coded as shown in the legend to the right of the plot.

```{r}

# plotting conventionality 
conventionality_all <- ggplot(data, aes(Generation, Conventionality, fill = Condition)) +
  geom_bar(fun.y = "mean", stat = "summary", position = "dodge") +
  ggtitle("Evolution of conventionality") +
  stat_summary(geom = "errorbar", fun.data = mean_se, position = "dodge")

conventionality_all


# plotting complexity 
complexity_all <- ggplot(data, aes(Generation, Complexity, fill = Condition)) +
  geom_bar(fun.y = "mean", stat = "summary", position = "dodge") +
  ggtitle("Evolution of complexity") +
  stat_summary(geom = "errorbar", fun.data = mean_se, position = "dodge")

complexity_all


# plotting each chain seperately - conventionality
conventionality_chain <- ggplot(data, aes(Generation, Conventionality, fill = Condition)) +
  geom_bar(fun.y = "mean", stat = "summary", position = "dodge") +
  ggtitle("Evolution of conventionality across chains") +
  stat_summary(geom = "errorbar", fun.data = mean_se, position = "dodge") +
  facet_wrap(data$Chain)

conventionality_chain


# plotting each chain seperately - complexity
complexity_chain <- ggplot(data, aes(Generation, Complexity, fill = Condition)) +
  geom_bar(fun.y = "mean", stat = "summary", position = "dodge") +
  ggtitle("Evolution of complexity across chains") +
  stat_summary(geom = "errorbar", fun.data = mean_se, position = "dodge") +
  facet_wrap(data$Chain)

complexity_chain

```

